<div class="form-container">
  <form [formGroup]="productForm" (ngSubmit)="onSubmit()" class="product-form" novalidate>
    <h2>Crear producto</h2>

    <!-- NOMBRE -->
    <label>Nombre</label>
    <input
      formControlName="proName"
      type="text"
      maxlength="30"
      placeholder="Ej: iPhone 15 Pro"
    />
    <div *ngIf="submitted && productForm.controls['proName'].invalid" class="error-message">
      <small *ngIf="productForm.controls['proName'].errors?.['required']">
        El nombre es obligatorio.
      </small>
      <small *ngIf="productForm.controls['proName'].errors?.['maxlength']">
        Máximo 30 caracteres.
      </small>
      <small *ngIf="productForm.controls['proName'].errors?.['pattern']">
        El nombre no puede contener solo espacios.
      </small>
    </div>

    <!-- DESCRIPCIÓN -->
    <label>Descripción</label>
    <textarea
      formControlName="descript"
      maxlength="50"
      placeholder="Describe el producto..."
    ></textarea>
    <div *ngIf="submitted && productForm.controls['descript'].invalid" class="error-message">
      <small *ngIf="productForm.controls['descript'].errors?.['required']">
        La descripción es obligatoria.
      </small>
      <small *ngIf="productForm.controls['descript'].errors?.['maxlength']">
        Máximo 50 caracteres.
      </small>
      <small *ngIf="productForm.controls['descript'].errors?.['pattern']">
        Solo se permiten letras, números y espacios.
      </small>
    </div>

    <!-- MARCA -->
    <label>Marca</label>
    <input
      formControlName="proMark"
      type="text"
      maxlength="20"
      placeholder="Ej: Apple"
    />
    <div *ngIf="submitted && productForm.controls['proMark'].invalid" class="error-message">
      <small *ngIf="productForm.controls['proMark'].errors?.['required']">
        La marca es obligatoria.
      </small>
      <small *ngIf="productForm.controls['proMark'].errors?.['maxlength']">
        Máximo 20 caracteres.
      </small>
      <small *ngIf="productForm.controls['proMark'].errors?.['pattern']">
        Solo se permiten letras y espacios.
      </small>
    </div>

    <!-- PRECIO -->
    <label>Precio</label>
    <input
      formControlName="proPrice"
      type="number"
      (keypress)="onlyNumbers($event)"
      placeholder="Ej: 5999"
    />
    <div *ngIf="submitted && productForm.controls['proPrice'].invalid" class="error-message">
      <small *ngIf="productForm.controls['proPrice'].errors?.['required']">
        El precio es obligatorio.
      </small>
      <small *ngIf="productForm.controls['proPrice'].errors?.['min']">
        Debe ser mayor que 0.
      </small>
      <small *ngIf="productForm.controls['proPrice'].errors?.['max']">
        El precio no puede superar los 20 millones.
      </small>
    </div>

    <!-- TIPO -->
    <label>Tipo</label>
    <select formControlName="typeCode">
      <option value="">Selecciona tipo</option>
      <option *ngFor="let type of productTypes" [value]="type.typeCode">
        {{ type.typeName }}
      </option>
    </select>
    <div *ngIf="submitted && productForm.controls['typeCode'].invalid" class="error-message">
      <small>Selecciona un tipo de producto.</small>
    </div>

    <!-- IMAGEN -->
    <label>URL Imagen</label>
    <input
      formControlName="proImg"
      type="text"
      placeholder="https://ejemplo.com/imagen"
    />
    <div *ngIf="submitted && productForm.controls['proImg'].invalid" class="error-message">
      <small *ngIf="productForm.controls['proImg'].errors?.['required']">
        La URL de la imagen es obligatoria.
      </small>
      <small *ngIf="productForm.controls['proImg'].errors?.['pattern']">
        Ingresa una URL válida (http o https).
      </small>
    </div>

    <!-- BOTÓN -->
    <button type="submit">Guardar producto</button>
  </form>

  <!-- VISTA PREVIA -->
  <div class="preview" *ngIf="previewImage">
    <img [src]="previewImage" alt="Vista previa del producto" />
  </div>
</div>

<!-- TOAST -->
<div *ngIf="showToast" class="toast" [ngClass]="toastType">
  <img
    *ngIf="toastType === 'success'"
    class="toast-icon"
    src="https://cdn-icons-png.flaticon.com/512/845/845646.png"
    alt="Éxito"
  />
  <img
    *ngIf="toastType === 'error'"
    class="toast-icon"
    src="https://cdn-icons-png.flaticon.com/512/463/463612.png"
    alt="Error"
  />
  <p>{{ toastMessage }}</p>
</div>
