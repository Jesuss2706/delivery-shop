<!-- Breadcrumb -->
<div class="breadcrumb">
  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
  </svg>
  <span>/</span>
  <span>Tienda</span>
  <span>/</span>
  <span class="active">Productos</span>
</div>

<!-- Page Title -->
<h1 class="page-title">Productos</h1>

<!-- Toast Notification -->
<div *ngIf="toast.show" 
     class="toast-notification toast-{{toast.type}}"
     [class.show]="toast.show"
     (click)="closeToast()">
  <div class="toast-icon">
    <span *ngIf="toast.type === 'success'">✅</span>
    <span *ngIf="toast.type === 'error'">❌</span>
  </div>
  <div class="toast-content">
    <p class="toast-message">{{ toast.message }}</p>
  </div>
  <button class="toast-close" (click)="closeToast()">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <line x1="18" y1="6" x2="6" y2="18"></line>
      <line x1="6" y1="6" x2="18" y2="18"></line>
    </svg>
  </button>
</div>

<!-- Products Grid -->
<div class="products-grid">
  <div 
    class="product-card" 
    *ngFor="let item of filteredItems"
    (click)="viewProductDetail(item.invCode!)"
    role="button"
    tabindex="0"
    (keydown.enter)="viewProductDetail(item.invCode!)">

    <div class="product-image">
      <img 
        [src]="item.product.proImg || 'assets/placeholder-product.jpg'" 
        [alt]="item.product.proName"
        loading="lazy">
    </div>
   
    <div class="product-info">
      <h3 class="product-name">{{ item.product.proName }}</h3>
      <p class="product-description">{{ item.product.descript }}</p>
      <p class="product-mark">Marca: {{ item.product.proMark }}</p>
      <p class="product-type">Categoría: {{ item.product.productType.typeName }}</p>
      
      <div class="product-footer">
        <span class="product-price">{{ formatPrice(item.sellingPrice) }}</span>
        <button 
          class="add-to-cart-btn"
          (click)="addToCart($event, item)"
          [disabled]="isLoadingProduct(item.invCode!)"
          [class.loading]="isLoadingProduct(item.invCode!)"
          type="button">
          
          <!-- Estado normal -->
          <span *ngIf="!isLoadingProduct(item.invCode!)" class="btn-content">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="9" cy="21" r="1"></circle>
              <circle cx="20" cy="21" r="1"></circle>
              <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
            </svg>
            Agregar
          </span>
          
          <!-- Estado loading -->
          <span *ngIf="isLoadingProduct(item.invCode!)" class="btn-content loading">
            <span class="spinner">⏳</span>
            Añadiendo...
          </span>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Empty State -->
<div class="empty-state" *ngIf="filteredItems.length === 0">
  <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
    <circle cx="12" cy="12" r="10"></circle>
    <path d="M16 16s-1.5-2-4-2-4 2-4 2"></path>
    <line x1="9" y1="9" x2="9.01" y2="9"></line>
    <line x1="15" y1="9" x2="15.01" y2="9"></line>
  </svg>
  <h3>No hay productos disponibles</h3>
  <p>No se encontraron productos en esta categoría</p>
</div>